import{a as u,C as r,P as l}from"./assets/PrayerTimes-ByPlmll6.js";const d={MuslimWorldLeague:r.MuslimWorldLeague,ISNA:r.NorthAmerica,Egyptian:r.Egyptian,Karachi:r.Karachi,UmmAlQura:r.UmmAlQura,Dubai:r.Dubai,Kuwait:r.Kuwait,Qatar:r.Qatar,Singapore:r.Singapore,Tehran:r.Tehran,Turkey:r.Turkey},g={fajr:"Fajr",sunrise:"Sunrise",dhuhr:"Dhuhr",asr:"Asr",maghrib:"Maghrib",isha:"Isha"};async function y(){return new Promise(e=>{chrome.storage.local.get("settings",a=>{e(a.settings??{latitude:0,longitude:0,method:"MuslimWorldLeague",notifications:!0})})})}function m(){y().then(e=>{if(!e.latitude||!e.longitude||!e.notifications)return;const a=new u(e.latitude,e.longitude),c=(d[e.method]||r.MuslimWorldLeague)(),o=new Date,t=new l(a,o,c),h=[{key:"fajr",time:t.fajr},{key:"dhuhr",time:t.dhuhr},{key:"asr",time:t.asr},{key:"maghrib",time:t.maghrib},{key:"isha",time:t.isha}];chrome.alarms.clearAll(()=>{for(const s of h)s.time>o&&chrome.alarms.create(`prayer-${s.key}`,{when:s.time.getTime()});const i=new Date(o);i.setDate(i.getDate()+1),i.setHours(0,1,0,0),chrome.alarms.create("daily-reschedule",{when:i.getTime()})})})}chrome.runtime.onInstalled.addListener(()=>{m()});chrome.alarms.onAlarm.addListener(e=>{if(e.name==="daily-reschedule"){m();return}if(e.name.startsWith("prayer-")){const a=e.name.replace("prayer-",""),n=g[a]||a;chrome.notifications.create(e.name,{type:"basic",iconUrl:"icons/icon-128.png",title:`ðŸ•Œ ${n} Time`,message:`It's time for ${n} prayer.`,priority:2})}});chrome.storage.onChanged.addListener(e=>{e.settings&&m()});
